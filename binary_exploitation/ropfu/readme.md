                                                                                                
┌──(secretK㉿thebattle)-[~/picoCTF/binary_exploitation/ropfu]
└─$ gdb vuln
GNU gdb (Debian 13.2-1) 13.2
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
GEF for linux ready, type `gef' to start, `gef config' to configure
88 commands loaded and 5 functions added for GDB 13.2 in 0.00ms using Python engine 3.11
Reading symbols from vuln...
(No debugging symbols found in vuln)
gef➤  *main
Undefined command: "".  Try "help".
gef➤  b *main
Breakpoint 1 at 0x8049dc1
gef➤  r
Starting program: /home/secretK/picoCTF/binary_exploitation/ropfu/vuln 

Breakpoint 1, 0x08049dc1 in main ()





[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0x080e685c  →  0xffffd01c  →  0xffffd216  →  "COLORFGBG=15;0"
$ebx   : 0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$ecx   : 0x0       
$edx   : 0xffffcfb0  →  0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$esp   : 0xffffcf5c  →  0x0804a66d  →  <__libc_start_main+1309> add esp, 0x10
$ebp   : 0x0       
$esi   : 0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$edi   : 0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$eip   : 0x08049dc1  →  <main+0> endbr32 
$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 
───────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffcf5c│+0x0000: 0x0804a66d  →  <__libc_start_main+1309> add esp, 0x10        ← $esp
0xffffcf60│+0x0004: 0x00000001
0xffffcf64│+0x0008: 0xffffd014  →  0xffffd1e1  →  "/home/secretK/picoCTF/binary_exploitation/ropfu/vu[...]"
0xffffcf68│+0x000c: 0xffffd01c  →  0xffffd216  →  "COLORFGBG=15;0"
0xffffcf6c│+0x0010: 0xffffcfb0  →  0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
0xffffcf70│+0x0014: 0x00000000
0xffffcf74│+0x0018: 0x00000000
0xffffcf78│+0x001c: 0x00000000
─────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049dbc <vuln+55>        mov    ebx, DWORD PTR [ebp-0x4]
    0x8049dbf <vuln+58>        leave  
    0x8049dc0 <vuln+59>        ret    
 →  0x8049dc1 <main+0>         endbr32 
    0x8049dc5 <main+4>         lea    ecx, [esp+0x4]
    0x8049dc9 <main+8>         and    esp, 0xfffffff0
    0x8049dcc <main+11>        push   DWORD PTR [ecx-0x4]
    0x8049dcf <main+14>        push   ebp
    0x8049dd0 <main+15>        mov    ebp, esp
─────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "vuln", stopped 0x8049dc1 in main (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049dc1 → main()
────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  




┌──(secretK㉿thebattle)-[~/picoCTF/binary_exploitation/ropfu]
└─$ subl readme.md
                                                                                                
┌──(secretK㉿thebattle)-[~/picoCTF/binary_exploitation/ropfu]
└─$ gdb vuln          
GNU gdb (Debian 13.2-1) 13.2
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
GEF for linux ready, type `gef' to start, `gef config' to configure
88 commands loaded and 5 functions added for GDB 13.2 in 0.00ms using Python engine 3.11
Reading symbols from vuln...
(No debugging symbols found in vuln)
gef➤  pattern create 100
[+] Generating a pattern of 100 bytes (n=4)
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
[+] Saved as '$_gef0'
gef➤  r
Starting program: /home/secretK/picoCTF/binary_exploitation/ropfu/vuln 
How strong is your ROP-fu? Snatch the shell from my hand, grasshopper!
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa

Program received signal SIGSEGV, Segmentation fault.
0x61616168 in ?? ()
[ Legend: Modified register | Code | Heap | Stack | String ]
───────────────────────────────────────────────────────────────────────────────── registers ────
$eax   : 0xffffcf10  →  "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]"
$ebx   : 0x61616166 ("faaa"?)
$ecx   : 0x080e5300  →  <_IO_2_1_stdin_+0> mov BYTE PTR [edx], ah
$edx   : 0xffffcf74  →  0x00000000
$esp   : 0xffffcf30  →  "iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]"
$ebp   : 0x61616167 ("gaaa"?)
$esi   : 0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$edi   : 0x080e5000  →  <_GLOBAL_OFFSET_TABLE_+0> add BYTE PTR [eax], al
$eip   : 0x61616168 ("haaa"?)
$eflags: [zero carry parity adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]
$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 
───────────────────────────────────────────────────────────────────────────────────── stack ────
0xffffcf30│+0x0000: "iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]"    ← $esp
0xffffcf34│+0x0004: "jaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaava[...]"
0xffffcf38│+0x0008: "kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawa[...]"
0xffffcf3c│+0x000c: "laaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxa[...]"
0xffffcf40│+0x0010: "maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]"
0xffffcf44│+0x0014: "naaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffcf48│+0x0018: "oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
0xffffcf4c│+0x001c: "paaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa"
─────────────────────────────────────────────────────────────────────────────── code:x86:32 ────
[!] Cannot disassemble from $PC
[!] Cannot access memory at address 0x61616168
─────────────────────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "vuln", stopped 0x61616168 in ?? (), reason: SIGSEGV
───────────────────────────────────────────────────────────────────────────────────── trace ────
────────────────────────────────────────────────────────────────────────────────────────────────
gef➤  pattern offset haaa
[+] Searching for '61616168'/'68616161' with period=4
[+] Found at offset 25 (little-endian search) likely
gef➤  r
Starting program: /home/secretK/picoCTF/binary_exploitation/ropfu/vuln 
How strong is your ROP-fu? Snatch the shell from my hand, grasshopper!



picoCTF{5n47ch_7h3_5h311_e81af635}